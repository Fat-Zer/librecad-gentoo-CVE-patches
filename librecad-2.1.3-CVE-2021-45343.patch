Origin: https://sources.debian.org/patches/librecad/2.1.3-3/CVE-2021-45343.patch/
Bug: https://bugs.gentoo.org/832210

From 5771425808bd16e78e1c6f28728c0712c47316f7 Mon Sep 17 00:00:00 2001
From: eldstal <laeder.keps@gmail.com>
Date: Sun, 19 Dec 2021 17:57:07 +0100
Subject: [PATCH 05/14] Added NULL check for hatch code 93

This fixes issue #1468
---
 libraries/libdxfrw/src/drw_entities.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libraries/libdxfrw/src/drw_entities.cpp b/libraries/libdxfrw/src/drw_entities.cpp
index b4f6cd02..9c9d9b77 100644
--- a/libraries/libdxfrw/src/drw_entities.cpp
+++ b/libraries/libdxfrw/src/drw_entities.cpp
@@ -1805,7 +1805,7 @@ void DRW_Hatch::parseCode(int code, dxfReader *reader){
         break;
     case 93:
         if (pline) pline->vertexnum = reader->getInt32();
-        else loop->numedges = reader->getInt32();//aqui reserve
+        else if (loop) loop->numedges = reader->getInt32();//aqui reserve
         break;
     case 98: //seed points ??
         clearEntities();
-- 
2.30.2

